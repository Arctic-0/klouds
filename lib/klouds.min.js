!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.klouds=r():e.klouds=r()}(window,(function(){return function(e){var r={};function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(o,n,function(r){return e[r]}.bind(null,n));return o},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";r.__esModule=!0,r.create=r.Klouds=r.VERSION=void 0;var o=t(1),n=t(2),i=t(3);function a(e){var r=[0,0,0];return"string"==typeof e?function(e){var r=document.createElement("div");r.style.display="none",r.style.color=e,document.body.appendChild(r);var t=(getComputedStyle(r).color||"rgb(0, 0, 0)").match(/[+-]?\d+(\.\d+)?/g),o=t?t.map((function(e){return parseInt(e,10)})):[0,0,0];if(r.parentElement&&r.parentElement.removeChild(r),o.length>3)o.length=3;else if(o.length<3)return[0,0,0];return o}(e).forEach((function(e,t){r[t]=e/255})):Array.isArray(e)&&3===e.length&&e.slice(0,3).forEach((function(e,t){r[t]=e/255})),r}r.VERSION="2.1.0";var l=function(){function e(e){var r=this;this.isRunning=!1,this.accumTime=0,this.lastTime=performance.now(),this.render=function(e){var t=r.gl,o=r.program,n=r.buffer,a=(e-r.lastTime)*r.speed*.001;r.accumTime+=a,r.lastTime=e,i.resizeCanvasToDisplaySize(r.canvas),t.viewport(0,0,t.canvas.width,t.canvas.height),t.useProgram(o.handle),t.bindBuffer(t.ARRAY_BUFFER,n);var l=o.attributes.position;t.enableVertexAttribArray(l),t.vertexAttribPointer(l,3,t.FLOAT,!1,0,0),t.uniform2f(o.uniforms.resolution,t.canvas.width,t.canvas.height),t.uniform1f(o.uniforms.layerCount,r.layerCount),t.uniform1f(o.uniforms.time,r.accumTime),t.uniform3fv(o.uniforms.bgColor,r.bgColor),t.uniform3fv(o.uniforms.cloudColor1,r.cloudColor1),t.uniform3fv(o.uniforms.cloudColor2,r.cloudColor2),t.drawArrays(t.TRIANGLES,0,6),r.isRunning&&requestAnimationFrame(r.render)};var t=this.queryRootElement(e.selector);if(!t)throw new Error("Invalid options.selector value passed to Klouds");this.canvas=t;var o=e.speed||1,n=e.layerCount||5,a=e.cloudColor1||[25,178,204],l=e.cloudColor2||[255,255,255],u=e.bgColor||[0,102,128];t.style.width="100%",t.style.height="100%",this.initGraphics(t),this.setSpeed(o),this.setLayerCount(n),this.setBgColor(u),this.setCloudColor1(a),this.setCloudColor2(l),this.start()}return e.prototype.queryRootElement=function(e){if("string"==typeof e){var r=document.querySelector(e);return r?r instanceof HTMLCanvasElement?r:(console.error("options.selector element is not a <canvas> element"),null):(console.error("options.selector element not found"),null)}return e instanceof HTMLElement?e instanceof HTMLCanvasElement?e:(console.error("options.selector element is not a <canvas> element"),null):(console.error("options.selector value is invalid"),null)},e.prototype.initGraphics=function(e){var r=i.createContext(e);if(!r)throw new Error("Failed to create WebGL context");var t=i.createProgram(r,o.default,n.default,["position"],["resolution","layerCount","time","bgColor","cloudColor1","cloudColor2"]);if(!t)throw new Error("Failed to create WebGL program");var a=r.createBuffer();if(!a)throw r.deleteProgram(t),new Error("Failed to create WebGL buffer");var l=t.attributes.position;r.enableVertexAttribArray(l),r.vertexAttribPointer(l,3,r.FLOAT,!1,0,0);r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,new Float32Array([[-1,-1,0],[1,-1,0],[-1,1,0],[-1,1,0],[1,-1,0],[1,1,0]].reduce((function(e,r){return e.concat(r)}),[])),r.STATIC_DRAW),this.gl=r,this.program=t,this.buffer=a},e.prototype.start=function(){this.isRunning||(this.isRunning=!0,requestAnimationFrame(this.render))},e.prototype.stop=function(){this.isRunning=!1},e.prototype.setSpeed=function(e){this.speed=Math.max(-100,Math.min(100,e))},e.prototype.setCloudColor1=function(e){var r=a(e);r&&(this.cloudColor1=r)},e.prototype.setCloudColor2=function(e){var r=a(e);r&&(this.cloudColor2=r)},e.prototype.setBgColor=function(e){var r=a(e);r&&(this.bgColor=r)},e.prototype.setLayerCount=function(e){this.layerCount=Math.max(1,Math.min(8,e))/10},e.prototype.getSpeed=function(){return this.speed},e.prototype.getLayerCount=function(){return this.layerCount},e.prototype.getBgColor=function(){return this.bgColor.slice()},e.prototype.getCloudColor1=function(){return this.cloudColor1.slice()},e.prototype.getCloudColor2=function(){return this.cloudColor2.slice()},e}();r.Klouds=l,r.create=function(e){return new l(e)},window&&void 0!==window.jQuery&&(window.jQuery.fn.Klouds=function(e){e=e||{};for(var r=this.get(),t=[],o=0;o<r.length;++o)e.selector=r[o],t.push(new l(e));return t})},function(e,r,t){"use strict";t.r(r),r.default="attribute vec3 position;\r\n\r\nvoid main() {\r\n    gl_Position = vec4(position, 1.0);\r\n}\r\n"},function(e,r,t){"use strict";t.r(r),r.default="precision mediump float;\r\n\r\nuniform vec2 resolution;\r\nuniform float layerCount;\r\nuniform float time;\r\nuniform vec3 bgColor;\r\nuniform vec3 cloudColor1;\r\nuniform vec3 cloudColor2;\r\n\r\n#define TAU 6.28318530718\r\n\r\nfloat func(float pX) {\r\n    return 0.6 * (0.5 * sin(0.1 * pX) + 0.5 * sin(0.553 * pX) + 0.7 * sin(1.2 * pX));\r\n}\r\n\r\nfloat funcR(float pX) {\r\n    return 0.5 + 0.25 * (1.0 + sin(mod(40.0 * pX, TAU)));\r\n}\r\n\r\nfloat layer(vec2 pQ, float pT) {\r\n    vec2 Qt = 3.5 * pQ;\r\n    pT *= 0.5;\r\n    Qt.x += pT;\r\n\r\n    float Xi = floor(Qt.x);\r\n    float Xf = Qt.x - Xi - 0.5;\r\n\r\n    vec2 C;\r\n    float Yi;\r\n    float D = 1.0 - step(Qt.y,  func(Qt.x));\r\n\r\n    Yi = func(Xi + 0.5);\r\n    C = vec2(Xf, Qt.y - Yi ); \r\n    D =  min(D, length(C) - funcR(Xi + pT / 80.0));\r\n\r\n    Yi = func(Xi + 1.0 + 0.5);\r\n    C = vec2(Xf - 1.0, Qt.y - Yi ); \r\n    D =  min(D, length(C) - funcR(Xi + 1.0+ pT / 80.0));\r\n\r\n    Yi = func(Xi - 1.0 + 0.5);\r\n    C = vec2(Xf + 1.0, Qt.y - Yi ); \r\n    D =  min(D, length(C) - funcR(Xi - 1.0 + pT / 80.0));\r\n\r\n    return min(1.0, D);\r\n}\r\n\r\nvoid main() {\r\n    float t = time;\r\n    vec2 UV = 2.0 * (gl_FragCoord.xy - resolution.xy / 2.0) / min(resolution.x, resolution.y);\t\r\n    \r\n    vec3 Color = bgColor;\r\n\r\n    for(float i = 0.0; i < 0.8; i += 0.1) {\r\n        if (i >= layerCount) {\r\n            break;\r\n        }\r\n\r\n        float Lt =  t * (0.5 + 2.0 * i) * (1.0 + 0.1 * sin(226.0 * i)) + 1000.0 * i;\r\n        vec2 Lp = vec2(100.0 * i, 0.8 * (i / (layerCount - 0.0999) / 0.8) - 0.3);\r\n        float L = layer(UV + Lp, Lt);\r\n\r\n        float Blur = 4.0 * (0.5 * abs(2.0 - 5.0 * i)) / (11.0 - 5.0 * i);\r\n\r\n        float V = mix(0.0, 1.0, 1.0 - smoothstep(0.0, 0.01 + 0.2 * Blur, L));\r\n        vec3 Lc = mix(cloudColor1, cloudColor2, i / (layerCount - 0.0999) / 0.8);\r\n\r\n        Color = mix(Color, Lc,  V);\r\n    }\r\n\r\n    gl_FragColor = vec4(Color, 1.0);\r\n}\r\n"},function(e,r,t){"use strict";var o;function n(e,r,t){var n=r===o.VERTEX?e.createShader(e.VERTEX_SHADER):e.createShader(e.FRAGMENT_SHADER);return n?(e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.debug(e.getShaderInfoLog(n)),console.error("Failed to compile WebGL shader"),e.deleteShader(n),null)):(console.error("Failed to create WebGL shader"),null)}r.__esModule=!0,r.resizeCanvasToDisplaySize=r.createProgram=r.createShader=r.ShaderType=r.createContext=void 0,r.createContext=function(e){return e.getContext("webgl")},function(e){e[e.VERTEX=0]="VERTEX",e[e.FRAGMENT=1]="FRAGMENT"}(o=r.ShaderType||(r.ShaderType={})),r.createShader=n,r.createProgram=function(e,r,t,i,a){var l=e.createProgram();if(!l)return console.error("Failed to create WebGL program"),null;var u=n(e,o.VERTEX,r),s=n(e,o.FRAGMENT,t);if(!u||!s)return console.error("Failed to create a shader while creating a program"),null;if(e.attachShader(l,u),e.attachShader(l,s),e.linkProgram(l),e.validateProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))return e.deleteProgram(l),e.deleteShader(u),e.deleteShader(s),console.error("Failed to link WebGL program"),console.debug(e.getProgramInfoLog(l)),null;if(!e.getProgramParameter(l,e.VALIDATE_STATUS))return e.deleteProgram(l),e.deleteShader(u),e.deleteShader(s),console.error("Failed to validate WebGL program"),console.debug(e.getProgramInfoLog(l)),null;for(var c={},f=0;f<i.length;++f){var d=i[f],p=e.getAttribLocation(l,d);if(-1===p)return console.error('Program attribute named "'+d+"\" doesn't exist"),e.deleteProgram(l),null;c[d]=p}var m={};for(f=0;f<a.length;++f){var h=a[f],g=e.getUniformLocation(l,h);if(null===g)return console.error('Program uniform named "'+h+"\" doesn't exist"),e.deleteProgram(l),null;m[h]=g}return{handle:l,attributes:c,uniforms:m}},r.resizeCanvasToDisplaySize=function(e){var r=e.clientWidth,t=e.clientHeight;return(e.width!==r||e.height!==t)&&(e.width=r,e.height=t,!0)}}])}));
//# sourceMappingURL=klouds.min.js.map